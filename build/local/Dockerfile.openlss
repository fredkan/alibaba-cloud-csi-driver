FROM k8s.gcr.io/build-image/debian-base:v2.1.3
LABEL description="OpenLSS CSI Driver"

RUN clean-install ca-certificates file tzdata xfsprogs e2fsprogs mount pciutils lvm2

COPY nsenter /nsenter
COPY plugin.csi.alibabacloud.com /bin/plugin.csi.alibabacloud.com
COPY entrypoint.sh /entrypoint.sh
RUN chmod +x /bin/plugin.csi.alibabacloud.com && chmod +x /entrypoint.sh && sed -i 's/use_lvmetad\ =\ 1/use_lvmetad\ =\ 0/g' /etc/lvm/lvm.conf
ENTRYPOINT ["/entrypoint.sh"]